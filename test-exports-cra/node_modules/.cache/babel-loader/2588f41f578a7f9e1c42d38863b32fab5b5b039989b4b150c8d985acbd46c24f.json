{"ast":null,"code":"import { Tool } from \"./base.js\";\n/**\n * Wrapper around serper.\n *\n * You can create a free API key at https://serper.dev.\n *\n * To use, you should have the SERPER_API_KEY environment variable set.\n */\nexport class Serper extends Tool {\n  constructor() {\n    let apiKey = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : typeof process !== \"undefined\" ?\n    // eslint-disable-next-line no-process-env\n    process.env.SERPER_API_KEY : undefined;\n    let params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    super();\n    Object.defineProperty(this, \"key\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"params\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"name\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: \"search\"\n    });\n    Object.defineProperty(this, \"description\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: \"a search engine. useful for when you need to answer questions about current events. input should be a search query.\"\n    });\n    if (!apiKey) {\n      throw new Error(\"Serper API key not set. You can set it as SERPER_API_KEY in your .env file, or pass it to Serper.\");\n    }\n    this.key = apiKey;\n    this.params = params;\n  }\n  /**\n   * Run query through SerpAPI and parse result\n   */\n  async _call(input) {\n    const options = {\n      method: \"POST\",\n      headers: {\n        \"X-API-KEY\": this.key,\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        q: input,\n        ...this.params\n      })\n    };\n    const res = await fetch(\"https://google.serper.dev/search\", options);\n    if (!res.ok) {\n      throw new Error(`Got ${res.status} error from serper: ${res.statusText}`);\n    }\n    const json = await res.json();\n    if (json.answerBox?.answer) {\n      return json.answerBox.answer;\n    }\n    if (json.answerBox?.snippet) {\n      return json.answerBox.snippet;\n    }\n    if (json.answerBox?.snippet_highlighted_words) {\n      return json.answerBox.snippet_highlighted_words[0];\n    }\n    if (json.sportsResults?.game_spotlight) {\n      return json.sportsResults.game_spotlight;\n    }\n    if (json.knowledgeGraph?.description) {\n      return json.knowledgeGraph.description;\n    }\n    if (json.organic?.[0]?.snippet) {\n      return json.organic[0].snippet;\n    }\n    return \"No good search result found\";\n  }\n}","map":{"version":3,"names":["Tool","Serper","constructor","apiKey","arguments","length","undefined","process","env","SERPER_API_KEY","params","Object","defineProperty","enumerable","configurable","writable","value","Error","key","_call","input","options","method","headers","body","JSON","stringify","q","res","fetch","ok","status","statusText","json","answerBox","answer","snippet","snippet_highlighted_words","sportsResults","game_spotlight","knowledgeGraph","description","organic"],"sources":["/Users/b/Code/langchainjs/langchain/dist/tools/serper.js"],"sourcesContent":["import { Tool } from \"./base.js\";\n/**\n * Wrapper around serper.\n *\n * You can create a free API key at https://serper.dev.\n *\n * To use, you should have the SERPER_API_KEY environment variable set.\n */\nexport class Serper extends Tool {\n    constructor(apiKey = typeof process !== \"undefined\"\n        ? // eslint-disable-next-line no-process-env\n            process.env.SERPER_API_KEY\n        : undefined, params = {}) {\n        super();\n        Object.defineProperty(this, \"key\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"params\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"name\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"search\"\n        });\n        Object.defineProperty(this, \"description\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"a search engine. useful for when you need to answer questions about current events. input should be a search query.\"\n        });\n        if (!apiKey) {\n            throw new Error(\"Serper API key not set. You can set it as SERPER_API_KEY in your .env file, or pass it to Serper.\");\n        }\n        this.key = apiKey;\n        this.params = params;\n    }\n    /**\n     * Run query through SerpAPI and parse result\n     */\n    async _call(input) {\n        const options = {\n            method: \"POST\",\n            headers: {\n                \"X-API-KEY\": this.key,\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({\n                q: input,\n                ...this.params,\n            }),\n        };\n        const res = await fetch(\"https://google.serper.dev/search\", options);\n        if (!res.ok) {\n            throw new Error(`Got ${res.status} error from serper: ${res.statusText}`);\n        }\n        const json = await res.json();\n        if (json.answerBox?.answer) {\n            return json.answerBox.answer;\n        }\n        if (json.answerBox?.snippet) {\n            return json.answerBox.snippet;\n        }\n        if (json.answerBox?.snippet_highlighted_words) {\n            return json.answerBox.snippet_highlighted_words[0];\n        }\n        if (json.sportsResults?.game_spotlight) {\n            return json.sportsResults.game_spotlight;\n        }\n        if (json.knowledgeGraph?.description) {\n            return json.knowledgeGraph.description;\n        }\n        if (json.organic?.[0]?.snippet) {\n            return json.organic[0].snippet;\n        }\n        return \"No good search result found\";\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}