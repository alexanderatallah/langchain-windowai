{"ast":null,"code":"import { InfoSqlTool, ListTablesSqlTool, QueryCheckerTool, QuerySqlTool } from \"../../../tools/sql.js\";\nimport { Toolkit } from \"../base.js\";\nimport { SQL_PREFIX, SQL_SUFFIX } from \"./prompt.js\";\nimport { renderTemplate } from \"../../../prompts/template.js\";\nimport { LLMChain } from \"../../../chains/llm_chain.js\";\nimport { ZeroShotAgent } from \"../../mrkl/index.js\";\nimport { AgentExecutor } from \"../../executor.js\";\nexport class SqlToolkit extends Toolkit {\n  constructor(db) {\n    super();\n    Object.defineProperty(this, \"tools\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"db\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"dialect\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: \"sqlite\"\n    });\n    this.db = db;\n    this.tools = [new QuerySqlTool(db), new InfoSqlTool(db), new ListTablesSqlTool(db), new QueryCheckerTool()];\n  }\n}\nexport function createSqlAgent(llm, toolkit, args) {\n  const {\n    prefix = SQL_PREFIX,\n    suffix = SQL_SUFFIX,\n    inputVariables = [\"input\", \"agent_scratchpad\"],\n    topK = 10\n  } = args ?? {};\n  const {\n    tools\n  } = toolkit;\n  const formattedPrefix = renderTemplate(prefix, \"f-string\", {\n    dialect: toolkit.dialect,\n    top_k: topK\n  });\n  const prompt = ZeroShotAgent.createPrompt(tools, {\n    prefix: formattedPrefix,\n    suffix,\n    inputVariables\n  });\n  const chain = new LLMChain({\n    prompt,\n    llm\n  });\n  const agent = new ZeroShotAgent({\n    llmChain: chain,\n    allowedTools: tools.map(t => t.name)\n  });\n  return AgentExecutor.fromAgentAndTools({\n    agent,\n    tools,\n    returnIntermediateSteps: true\n  });\n}","map":{"version":3,"names":["InfoSqlTool","ListTablesSqlTool","QueryCheckerTool","QuerySqlTool","Toolkit","SQL_PREFIX","SQL_SUFFIX","renderTemplate","LLMChain","ZeroShotAgent","AgentExecutor","SqlToolkit","constructor","db","Object","defineProperty","enumerable","configurable","writable","value","tools","createSqlAgent","llm","toolkit","args","prefix","suffix","inputVariables","topK","formattedPrefix","dialect","top_k","prompt","createPrompt","chain","agent","llmChain","allowedTools","map","t","name","fromAgentAndTools","returnIntermediateSteps"],"sources":["/Users/b/Code/langchainjs/test-exports-cra/node_modules/langchain/dist/agents/agent_toolkits/sql/sql.js"],"sourcesContent":["import { InfoSqlTool, ListTablesSqlTool, QueryCheckerTool, QuerySqlTool, } from \"../../../tools/sql.js\";\nimport { Toolkit } from \"../base.js\";\nimport { SQL_PREFIX, SQL_SUFFIX } from \"./prompt.js\";\nimport { renderTemplate } from \"../../../prompts/template.js\";\nimport { LLMChain } from \"../../../chains/llm_chain.js\";\nimport { ZeroShotAgent } from \"../../mrkl/index.js\";\nimport { AgentExecutor } from \"../../executor.js\";\nexport class SqlToolkit extends Toolkit {\n    constructor(db) {\n        super();\n        Object.defineProperty(this, \"tools\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"db\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"dialect\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"sqlite\"\n        });\n        this.db = db;\n        this.tools = [\n            new QuerySqlTool(db),\n            new InfoSqlTool(db),\n            new ListTablesSqlTool(db),\n            new QueryCheckerTool(),\n        ];\n    }\n}\nexport function createSqlAgent(llm, toolkit, args) {\n    const { prefix = SQL_PREFIX, suffix = SQL_SUFFIX, inputVariables = [\"input\", \"agent_scratchpad\"], topK = 10, } = args ?? {};\n    const { tools } = toolkit;\n    const formattedPrefix = renderTemplate(prefix, \"f-string\", {\n        dialect: toolkit.dialect,\n        top_k: topK,\n    });\n    const prompt = ZeroShotAgent.createPrompt(tools, {\n        prefix: formattedPrefix,\n        suffix,\n        inputVariables,\n    });\n    const chain = new LLMChain({ prompt, llm });\n    const agent = new ZeroShotAgent({\n        llmChain: chain,\n        allowedTools: tools.map((t) => t.name),\n    });\n    return AgentExecutor.fromAgentAndTools({\n        agent,\n        tools,\n        returnIntermediateSteps: true,\n    });\n}\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,iBAAiB,EAAEC,gBAAgB,EAAEC,YAAY,QAAS,uBAAuB;AACvG,SAASC,OAAO,QAAQ,YAAY;AACpC,SAASC,UAAU,EAAEC,UAAU,QAAQ,aAAa;AACpD,SAASC,cAAc,QAAQ,8BAA8B;AAC7D,SAASC,QAAQ,QAAQ,8BAA8B;AACvD,SAASC,aAAa,QAAQ,qBAAqB;AACnD,SAASC,aAAa,QAAQ,mBAAmB;AACjD,OAAO,MAAMC,UAAU,SAASP,OAAO,CAAC;EACpCQ,WAAWA,CAACC,EAAE,EAAE;IACZ,KAAK,EAAE;IACPC,MAAM,CAACC,cAAc,CAAC,IAAI,EAAE,OAAO,EAAE;MACjCC,UAAU,EAAE,IAAI;MAChBC,YAAY,EAAE,IAAI;MAClBC,QAAQ,EAAE,IAAI;MACdC,KAAK,EAAE,KAAK;IAChB,CAAC,CAAC;IACFL,MAAM,CAACC,cAAc,CAAC,IAAI,EAAE,IAAI,EAAE;MAC9BC,UAAU,EAAE,IAAI;MAChBC,YAAY,EAAE,IAAI;MAClBC,QAAQ,EAAE,IAAI;MACdC,KAAK,EAAE,KAAK;IAChB,CAAC,CAAC;IACFL,MAAM,CAACC,cAAc,CAAC,IAAI,EAAE,SAAS,EAAE;MACnCC,UAAU,EAAE,IAAI;MAChBC,YAAY,EAAE,IAAI;MAClBC,QAAQ,EAAE,IAAI;MACdC,KAAK,EAAE;IACX,CAAC,CAAC;IACF,IAAI,CAACN,EAAE,GAAGA,EAAE;IACZ,IAAI,CAACO,KAAK,GAAG,CACT,IAAIjB,YAAY,CAACU,EAAE,CAAC,EACpB,IAAIb,WAAW,CAACa,EAAE,CAAC,EACnB,IAAIZ,iBAAiB,CAACY,EAAE,CAAC,EACzB,IAAIX,gBAAgB,EAAE,CACzB;EACL;AACJ;AACA,OAAO,SAASmB,cAAcA,CAACC,GAAG,EAAEC,OAAO,EAAEC,IAAI,EAAE;EAC/C,MAAM;IAAEC,MAAM,GAAGpB,UAAU;IAAEqB,MAAM,GAAGpB,UAAU;IAAEqB,cAAc,GAAG,CAAC,OAAO,EAAE,kBAAkB,CAAC;IAAEC,IAAI,GAAG;EAAI,CAAC,GAAGJ,IAAI,IAAI,CAAC,CAAC;EAC3H,MAAM;IAAEJ;EAAM,CAAC,GAAGG,OAAO;EACzB,MAAMM,eAAe,GAAGtB,cAAc,CAACkB,MAAM,EAAE,UAAU,EAAE;IACvDK,OAAO,EAAEP,OAAO,CAACO,OAAO;IACxBC,KAAK,EAAEH;EACX,CAAC,CAAC;EACF,MAAMI,MAAM,GAAGvB,aAAa,CAACwB,YAAY,CAACb,KAAK,EAAE;IAC7CK,MAAM,EAAEI,eAAe;IACvBH,MAAM;IACNC;EACJ,CAAC,CAAC;EACF,MAAMO,KAAK,GAAG,IAAI1B,QAAQ,CAAC;IAAEwB,MAAM;IAAEV;EAAI,CAAC,CAAC;EAC3C,MAAMa,KAAK,GAAG,IAAI1B,aAAa,CAAC;IAC5B2B,QAAQ,EAAEF,KAAK;IACfG,YAAY,EAAEjB,KAAK,CAACkB,GAAG,CAAEC,CAAC,IAAKA,CAAC,CAACC,IAAI;EACzC,CAAC,CAAC;EACF,OAAO9B,aAAa,CAAC+B,iBAAiB,CAAC;IACnCN,KAAK;IACLf,KAAK;IACLsB,uBAAuB,EAAE;EAC7B,CAAC,CAAC;AACN"},"metadata":{},"sourceType":"module","externalDependencies":[]}